import{_ as F}from"./bDhVN2i7.js";import{A as D}from"./Q_m3z1ei.js";import{r as a,n as z,h as P,o as r,s as I,w as u,u as M,c as v,d as q,B as f,F as U,a as t,b as g,q as V,E as S,x as j,y as H,t as k,I as G,G as X,z as K,A as R,v as J}from"./-qx6OsVB.js";import{_ as O}from"./DRJbnSa7.js";const Q={key:0},W={key:1},Y={class:"row"},Z={class:"row col-lg-4 mb-3 form-group required"},tt={class:"row mb-3 form-group required"},et=t("label",{for:"source-name",class:"col-sm-5 col-form-label control-label text-end"}," Tên quốc gia ",-1),ot={class:"col-sm-7"},nt={class:"row col-lg-4 mb-3 form-group required"},st={class:"row mb-3 form-group required"},at=t("label",{for:"source-name",class:"col-sm-5 col-form-label control-label text-end"}," Ảnh quốc gia ",-1),lt={class:"col-sm-7"},ct={class:"row col-lg-4 mb-3 form-group required"},rt={class:"row mb-3 form-group required"},it=t("label",{for:"source-name",class:"col-sm-5 col-form-label control-label text-end"}," Tên châu lục ",-1),dt={class:"col-sm-7"},ut=["value"],mt={class:"modal-footer align-content-center justify-content-center"},ht={key:0,type:"submit",class:"btn btn-sm btn-primary d-flex align-items-center"},yt={key:1,type:"submit",class:"btn btn-sm btn-primary d-flex align-items-center"},_t=t("button",{id:"closeModalButton",type:"button",class:"btn-close","data-bs-dismiss":"modal",hidden:""},null,-1),gt={__name:"TheFormCreateUpdateCountry",props:{editCountry:{type:Object,default:null,required:!1},isEditMode:{type:Boolean,default:!1,required:!0}},emits:["Country-saved"],setup(b,{emit:C}){const p=a(0),m=z.useToast(),w=a(null),d=new D,h=C,l=b,i=()=>{o.value.countryName="",o.value.countryImage="",o.value.continentName="",p.value+=1,x.value=""},x=a(""),o=a({countryName:"",countryImage:"",continentName:""}),B=[{id:1,value:"Châu Á"},{id:2,value:"Châu Âu"},{id:3,value:"Châu Mỹ"},{id:4,value:"Châu Phi"}],E=async e=>{const y=e.target.files[0];if(!y){alert("Vui lòng chọn một file.");return}if(!["image/jpeg","image/png"].includes(y.type)){alert("Chỉ chấp nhận ảnh có định dạng JPG hoặc PNG."),e.target.value="";return}const L=2*1024*1024;if(y.size>L){alert("Kích thước file không được vượt quá 2MB."),e.target.value="";return}const A=new FormData;A.append("ImageFile",y);try{const N=await d.postAPI("/Country/UploadFile",A);N.data&&(o.value.countryImage=N.data,m.success("Tải ảnh thành công!"),console.log("Ảnh đã được tải lên thành công:",N.data))}catch{m.error("Tải ảnh thất bại vui lòng tải lại")}},n=async()=>{try{const e=new FormData;e.append("countryName",o.value.countryName),e.append("countryImage",o.value.countryImage),e.append("continentName",o.value.continentName),await d.postAPI("/Country/InsertCountry",e),h("Country-saved"),m.success("Thêm thành công!"),document.getElementById("closeModalButton").click()}catch(e){console.error("Error creating Country:",e)}},c=()=>{const e={countryName:o.value.countryName,countryImage:o.value.countryImage,continentName:o.value.continentName,id:l.editCountry.id};d.putAPI(`/Country/${l.editCountry.id}`,e).then(s=>{h("Country-saved"),m.success("Cập nhật thành công!"),document.getElementById("closeModalButton").click()}).catch(s=>{console.error("Error updating Country:",s),x.value="Đã xảy ra lỗi khi cập nhật quốc gia. Vui lòng thử lại."})},T=async()=>{l.isEditMode?c():await n()};return P(()=>l.editCountry,e=>{e&&(o.value={...e})},{immediate:!0}),(e,s)=>{const y=F;return r(),I(y,{id_model:"create-update-Country-modal",onCloseModal:i},{icon:u(()=>[M(e.$slots,"icon")]),title:u(()=>[b.isEditMode?(r(),v("span",W,[M(e.$slots,"header",{},()=>[q("Cập nhật quốc gia")])])):(r(),v("span",Q,[M(e.$slots,"header",{},()=>[q("Thêm quốc gia")])]))]),body:u(()=>[(r(),I(f(U),{onSubmit:T,ref_key:"formRef",ref:w,key:p.value},{default:u(()=>[t("div",Y,[t("div",Z,[t("div",tt,[et,t("div",ot,[g(f(V),{name:"countryName",rules:{required:!0},modelValue:o.value.countryName,"onUpdate:modelValue":s[0]||(s[0]=_=>o.value.countryName=_),type:"text",class:"form-control"},null,8,["modelValue"]),g(f(S),{name:"countryName",class:"text-danger"})])])]),t("div",nt,[t("div",st,[at,t("div",lt,[g(f(V),{name:"countryImage",type:"file",rules:{required:!0},class:"form-control",onChange:E,accept:"image/jpeg, image/png, image/jpg"}),g(f(S),{name:"countryImage",class:"text-danger"})])])]),t("div",ct,[t("div",rt,[it,t("div",dt,[g(f(V),{name:"continentName",rules:{required:!0},modelValue:o.value.continentName,"onUpdate:modelValue":s[1]||(s[1]=_=>o.value.continentName=_),as:"select",class:"form-control"},{default:u(()=>[(r(),v(j,null,H(B,_=>t("option",{class:"text-dark",value:_.value},k(_.value),9,ut)),64))]),_:1},8,["modelValue"]),g(f(S),{name:"continentName",class:"text-danger"})])])])]),t("div",mt,[b.isEditMode?(r(),v("button",ht," Lưu ")):(r(),v("button",yt," Thêm ")),_t])]),_:1}))]),_:3})}}},pt=gt,vt=t("p",null,"Bạn có chắc chắn muốn xóa quốc gia này?",-1),ft=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Hủy bỏ ",-1),bt={__name:"DeleteCountryModal",props:{CountryId:{type:String,required:!0}},emits:["Country-deleted","hide-modal"],setup(b,{emit:C}){const p=z.useToast(),m=b,w=new D,d=C,h=()=>{const l=m.CountryId;w.deleteById("/Country",l).then(i=>{d("Country-deleted",l),d("hide-modal"),$(".btn-close").click(),p.success("Xóa thành công")}).catch(i=>{console.error("Lỗi khi xóa quốc gia:",i)})};return(l,i)=>{const x=F;return r(),I(x,{id_model:"deleteCountryModal"},{icon:u(()=>[M(l.$slots,"icon")]),title:u(()=>[M(l.$slots,"header",{},()=>[q("Xóa quốc gia này")])]),body:u(()=>[vt,t("div",{class:"modal-footer align-content-center justify-content-center"},[ft,t("button",{type:"button",class:"btn btn-danger",onClick:h}," Xóa ")])]),_:3})}}},Ct=bt,wt={class:"row"},xt={class:"p-4"},$t={class:"search"},Mt=t("h4",{class:"search-text h5"},"Quốc gia",-1),Nt=t("div",{class:"mt-3"},"Tìm kiếm:",-1),kt={class:"search-text d-flex align-content-center"},It={class:"col-md-3"},qt=t("span",{class:"button d-flex"},[t("button",{class:"ms-2 btn-sm me-1 btn btn-primary",type:"submit"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.5em",height:"1.5em",viewBox:"0 0 24 24"},[t("path",{fill:"currentColor",d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5A6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5S14 7.01 14 9.5S11.99 14 9.5 14"})]),q(" Tìm kiếm ")])],-1),Bt={class:"data"},Et={class:"btn-handle d-flex justify-content-end mb-3"},Tt={class:"handle-create"},Vt=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.5em",height:"1.5em",viewBox:"0 0 256 256"},[t("path",{fill:"currentColor",d:"M208 32H48a16 16 0 0 0-16 16v160a16 16 0 0 0 16 16h160a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16m-24 104h-48v48a8 8 0 0 1-16 0v-48H72a8 8 0 0 1 0-16h48V72a8 8 0 0 1 16 0v48h48a8 8 0 0 1 0 16"})],-1),St=[Vt],Dt={class:"table text-center table-hover table-success table-striped-columns"},At=t("thead",{class:"table-primary table-active"},[t("tr",null,[t("th",{scope:"col"},"No."),t("th",null,"Tên quốc gia"),t("th",{colspan:"2"},"Hình ảnh"),t("th",null,"Châu lục "),t("th",{scope:"col"},"Tác vụ")])],-1),Ft={class:"py-5 booking-id-col"},zt={class:"pt-5 w-10"},jt={colspan:"2",class:"p-4",style:{width:"17%"}},Ht=["src"],Lt={class:"pt-5 w-10"},Pt={class:"py-5"},Ut={class:"d-flex justify-content-center align-content-center align-items-center"},Gt=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},[t("path",{fill:"currentColor",d:"M5 18.08V19h.92l9.06-9.06l-.92-.92z",opacity:"0.3"}),t("path",{fill:"currentColor",d:"M20.71 7.04a.996.996 0 0 0 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29s-.51.1-.7.29l-1.83 1.83l3.75 3.75zM3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM5.92 19H5v-.92l9.06-9.06l.92.92z"})],-1),Xt=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 48 48"},[t("path",{fill:"currentColor",d:"M20 10.5v.5h8v-.5a4 4 0 0 0-8 0m-2.5.5v-.5a6.5 6.5 0 1 1 13 0v.5h11.25a1.25 1.25 0 1 1 0 2.5h-2.917l-2 23.856A7.25 7.25 0 0 1 29.608 44H18.392a7.25 7.25 0 0 1-7.224-6.644l-2-23.856H6.25a1.25 1.25 0 1 1 0-2.5zm4 9.25a1.25 1.25 0 1 0-2.5 0v14.5a1.25 1.25 0 1 0 2.5 0zM27.75 19c-.69 0-1.25.56-1.25 1.25v14.5a1.25 1.25 0 1 0 2.5 0v-14.5c0-.69-.56-1.25-1.25-1.25"})],-1),Qt={__name:"index",setup(b){const C=new D,p=a([]),m=a(null),w=a({}),d=a(!1),h=a("");a(1),a(0),a(0),a(10);const l=a("");l.value=localStorage.getItem("role");const i=async()=>{try{var n=await C.get("/Country",null);p.value=n.data.responseData}catch(c){console.log(c)}},x=async n=>{try{m.value=n}catch(c){console.log(c)}},o=async n=>{try{w.value={countryName:n.countryName,countryImage:n.countryImage,continentName:n.continentName,id:n.id},d.value=!0}catch(c){console.log(c)}},B=async()=>{try{d.value=!1}catch(n){console.log(n)}},E=async()=>{try{if(h.value){const n=await C.get(`/Country/SearchCountryNameAdmin/${h.value}`,null);p.value=n.data.responseData}else{i();return}}catch(n){console.log(n)}};return G(async()=>{await i()}),(n,c)=>{const T=pt,e=O;return r(),v("div",wt,[t("div",xt,[t("div",$t,[Mt,t("form",{name:"search",onSubmit:X(E,["prevent"])},[Nt,t("div",kt,[t("div",It,[K(t("input",{class:"form-control col-md-2","onUpdate:modelValue":c[0]||(c[0]=s=>h.value=s),type:"text",placeholder:" Tên quốc gia... "},null,512),[[R,h.value]])]),qt])],32)]),t("div",Bt,[t("div",Et,[t("div",Tt,[g(T,{isEditMode:d.value,editCountry:w.value,onCountrySaved:i},null,8,["isEditMode","editCountry"]),t("a",{onClick:B,href:"#","data-bs-toggle":"modal","data-bs-target":"#create-update-Country-modal"},St)])]),t("table",Dt,[At,t("tbody",null,[(r(!0),v(j,null,H(p.value,(s,y)=>(r(),v("tr",{key:y},[t("td",Ft,k(++y),1),t("td",zt,k(s.countryName),1),t("td",jt,[t("img",{src:s.countryImage,style:{width:"100%",height:"100%","object-fit":"contain"}},null,8,Ht)]),t("td",Lt,k(s.continentName),1),t("td",Pt,[t("div",Ut,[g(e,{class:"link link-primary text-decoration-none mx-1","data-bs-toggle":"modal","data-bs-target":"#create-update-Country-modal",onClick:_=>o(s),style:{cursor:"pointer"}},{default:u(()=>[Gt]),_:2},1032,["onClick"]),l.value=="Admin"?(r(),I(e,{key:0,class:"link link-danger text-decoration-none mx-1",style:{cursor:"pointer"},onClick:_=>x(s.id),"data-bs-toggle":"modal","data-bs-target":"#deleteCountryModal"},{default:u(()=>[Xt]),_:2},1032,["onClick"])):J("",!0)])])]))),128))])]),g(Ct,{CountryId:m.value,onCountryDeleted:i,onHideModal:c[1]||(c[1]=s=>i())},null,8,["CountryId"])])])])}}};export{Qt as default};
