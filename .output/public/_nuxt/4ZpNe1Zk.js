import{_ as C}from"./bDhVN2i7.js";import{n as B,r as u,o as c,s as V,w as f,u as x,d as S,a as e,G as q,c as i,z as p,A as g,t as P,v as m,a0 as T}from"./-qx6OsVB.js";import{A as D}from"./Q_m3z1ei.js";const N={key:0,class:"row mb-3 form-group required"},U=e("label",{for:"old-pass",class:"col-sm-3 col-form-label control-label text-end"}," Mật khẩu hiện tại ",-1),X={class:"col-sm-9"},z={key:0,class:"error-message text-danger"},E={class:"row mb-3 form-group required"},L=e("label",{for:"new-pass",class:"col-sm-3 col-form-label control-label text-end"},"Mật khẩu mới",-1),R={class:"col-sm-9"},j={key:0,class:"error-message text-danger"},F={class:"row mb-3 form-group required"},G=e("label",{for:"cf-pass",class:"col-sm-3 col-form-label control-label text-end"}," Xác nhận mật khẩu ",-1),O={class:"col-sm-9"},Z={key:0,class:"error-message text-danger"},H=e("div",{class:"modal-footer d-flex justify-content-center"},[e("button",{type:"submit",class:"btn btn-warning d-flex align-items-center"}," Lưu ")],-1),J={__name:"ChangePasswordModal",props:{accountId:{type:String,required:!0},isAdminChangeMode:{type:Boolean,default:!1}},setup(_){const k=B.useToast(),b=new D,d=_,n=u(""),t=u(""),r=u(""),s=u({currentPassword:"",newPassword:"",confirmPassword:""}),M=()=>{!d.isAdminChangeMode&&n.value.trim().length===0?s.value.currentPassword="Mật khẩu hiện tại không được để trống.":s.value.currentPassword=""},h=()=>t.value.trim().length===0?(s.value.newPassword="Mật khẩu mới không được để trống.",!1):t.value===n.value?(s.value.newPassword="Mật khẩu mới không được trùng với mật khẩu hiện tại.",!1):t.value.length<5?(s.value.newPassword="Mật khẩu mới phải chứa ít nhất 5 ký tự.",!1):/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{5,}$/.test(t.value)?(s.value.newPassword="",!0):(s.value.newPassword="Mật khẩu phải có ít nhất 5 ký tự gồm chữ hoa, chữ thường và số",!1),w=()=>r.value.trim().length===0?(s.value.confirmPassword="Xác nhận mật khẩu không được để trống.",!1):t.value!==r.value?(s.value.confirmPassword="Xác nhận mật khẩu không khớp với mật khẩu mới.",!1):(s.value.confirmPassword="",!0),y=()=>(M(),h(),w(),!s.value.currentPassword&&!s.value.newPassword&&!s.value.confirmPassword),A=()=>{if(y())if(d.isAdminChangeMode){const a={Id:d.accountId,Password:t.value};b.putAPI("/Account/editPassword",a).then(o=>{o.status===200&&(k.success("Đổi mật khẩu thành công"),$("#changePasswordModal").modal("hide"),$(".btn-close").click())}).catch(o=>{console.log(o)}),v()}else{const a={accountId:d.accountId,oldPassword:n.value,newPassword:t.value};b.putAPI("/Account/changePassword",a).then(o=>{o.status===200?(k.success("Đổi mật khẩu thành công"),localStorage.removeItem("token"),T("/Login"),$("#changePasswordModal").modal("hide"),$(".btn-close").click(),v()):s.value.currentPassword=o.data.Message||"Mật khẩu hiện tại không chính xác."})}},v=()=>{n.value="",t.value="",r.value="",s.value.currentPassword="",s.value.newPassword="",s.value.confirmPassword=""};return(a,o)=>{const I=C;return c(),V(I,{id_model:"changePasswordModal",onCloseModal:v},{icon:f(()=>[x(a.$slots,"icon")]),title:f(()=>[x(a.$slots,"header",{},()=>[S("Đổi mật khẩu")])]),body:f(()=>[e("form",{onSubmit:q(A,["prevent"])},[_.isAdminChangeMode?m("",!0):(c(),i("div",N,[U,e("div",X,[p(e("input",{type:"password","onUpdate:modelValue":o[0]||(o[0]=l=>n.value=l),onBlur:M,class:"form-control"},null,544),[[g,n.value]]),s.value.currentPassword?(c(),i("span",z,P(s.value.currentPassword),1)):m("",!0)])])),e("div",E,[L,e("div",R,[p(e("input",{type:"password","onUpdate:modelValue":o[1]||(o[1]=l=>t.value=l),onBlur:h,onInput:h,class:"form-control"},null,544),[[g,t.value]]),s.value.newPassword?(c(),i("span",j,P(s.value.newPassword),1)):m("",!0)])]),e("div",F,[G,e("div",O,[p(e("input",{type:"password","onUpdate:modelValue":o[2]||(o[2]=l=>r.value=l),onBlur:w,onInput:w,class:"form-control"},null,544),[[g,r.value]]),s.value.confirmPassword?(c(),i("span",Z,P(s.value.confirmPassword),1)):m("",!0)])]),H],32)]),_:3})}}},Y=J;export{Y as _};
