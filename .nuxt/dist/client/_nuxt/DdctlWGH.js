import{_ as S,a as B}from"./Dx-iEiGG.js";import{_ as w,Q as D,r as s,I as M,o as _,c as h,b as y,a as t,t as c,x as T,J as q,p as A,e as N}from"./-qx6OsVB.js";import{A as P}from"./Q_m3z1ei.js";import"./DRJbnSa7.js";const e=a=>(A("data-v-dfd4de16"),a=a(),N(),a),R=q('<section class="banner_inner" id="home" data-v-dfd4de16><div class="banner_inner_overlay" data-v-dfd4de16></div></section><div class="fs-5 border-bottom py-4" data-v-dfd4de16><div class="container d-flex flex-row" data-v-dfd4de16><div class="me-2 text-primary" data-v-dfd4de16>1. Nhập thông tin &gt;</div><div class="me-2 text-primary" data-v-dfd4de16>2. Đặt cọc &gt;</div><div class="text-primary" data-v-dfd4de16>3. Kết quả</div></div></div>',2),V={class:"container payment-response mt-4"},C=e(()=>t("h1",{class:"text-center"},"Kết quả đặt tour",-1)),F={key:0},L=e(()=>t("h2",{class:"text-success text-center"},"Đặt tour thành công!",-1)),E={class:"table table-bordered mt-3"},H=e(()=>t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"Thông tin"),t("th",null,"Giá trị")])],-1)),K=e(()=>t("td",null,"Mã đặt tour",-1)),U=e(()=>t("td",null,"Mã giao dịch",-1)),$=e(()=>t("td",null,"ID đơn hàng",-1)),G=e(()=>t("tr",null,[t("td",null,"Số tiền đặt cọc"),t("td",null,"100.000 vnd")],-1)),J=e(()=>t("td",null,"ID thanh toán",-1)),Q=e(()=>t("tr",null,[t("td",null,"Trạng thái thanh toán"),t("td",null,"Thành công")],-1)),j=e(()=>t("h6",null,"Thông tin đặt tour của bạn sẽ được gửi qua email bạn đã cung cấp .",-1)),z={key:1},O=e(()=>t("h2",{class:"text-center text-danger"},"Đặt tour thất bại!",-1)),W=e(()=>t("p",{class:"text-center"},"Vui lòng kiểm tra lại thông tin và thử lại.",-1)),X=[O,W],Y=e(()=>t("br",null,null,-1)),Z={__name:"index",setup(a){const p=new P,x=D(),l=s(!1),d=s(""),v=s(""),m=s(""),b=s(""),g=s(""),I=s("");s(""),M(async()=>{const n=x.query;if(l.value=n.success==="true",d.value=n.orderDescription||"",v.value=n.transactionId||"",m.value=n.orderId||"",b.value=n.paymentMethod||"",g.value=n.paymentId||"",I.value=n.vnPayResponseCode||"",l.value&&d.value){const o=parseInt(d.value,10);await k(o)}});const k=async n=>{try{const o=await p.putAPI(`/Booking/UpdateStatusToUnpaid?bookingId=${n}`);if(o.status===200){console.log("Cập nhật trạng thái thành công:",o.data);const{email:i,statusBill:r}=o.data,u=new FormData;u.append("to",i),u.append("status",r);const f=await p.postAPI(`/Booking/TestSendMailByStatus?id=${n}`,u);f.status===200?console.log("Email gửi thành công:",f.data):console.error("Lỗi cập nhật trạng thái email:",error)}else console.error("Lỗi cập nhật trạng thái booking:",error)}catch(o){console.error("Lỗi cập nhật trạng thái booking:",o)}};return(n,o)=>{const i=S,r=B;return _(),h(T,null,[y(i),R,t("div",V,[C,l.value?(_(),h("div",F,[L,t("table",E,[H,t("tbody",null,[t("tr",null,[K,t("td",null,c(d.value),1)]),t("tr",null,[U,t("td",null,c(v.value),1)]),t("tr",null,[$,t("td",null,c(m.value),1)]),G,t("tr",null,[J,t("td",null,c(g.value),1)]),Q])]),j])):(_(),h("div",z,X))]),Y,y(r)],64)}}},st=w(Z,[["__scopeId","data-v-dfd4de16"]]);export{st as default};
