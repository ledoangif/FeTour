{"version":3,"file":"Login-BUuWrkFi.js","sources":["../../../../assets/images/logo4.png","../../../../pages/Login.vue"],"sourcesContent":["export default \"__VITE_ASSET__DWDy1L7W__\""," <template>\r\n    <div class=\"login min-vh-100 min-vw-100\">\r\n        <div class=\"main pt-5\">\r\n            <div class=\"text-center p-5\">\r\n                <img\r\n                    src=\"../assets/images/logo4.png\"\r\n                    style=\"width: 15%; border-radius: 5%\"\r\n                    alt=\"logo\"\r\n                />\r\n            </div>\r\n            <div class=\"bg-light p-4 rounded shadow mx-auto\" style=\"width: 25%;\">\r\n                <div class=\"fs-3 text-center mb-4 text-dark\">ĐĂNG NHẬP TÀI KHOẢN</div>\r\n\r\n                <form @submit.prevent=\"login\">\r\n                    <div class=\"mt-10\">\r\n                        <div class=\"col-lg-12 mx-auto\">\r\n                            <div class=\"mb-4\">\r\n                                <input\r\n                                    type=\"text\"\r\n                                    class=\"form-control\"\r\n                                    v-model=\"User.email\"\r\n                                    name=\"email\"\r\n                                    placeholder=\"Email\"\r\n                                    @blur=\"validateEmail\"\r\n                                />\r\n                                <div v-if=\"emailError\" class=\"text-danger\">{{ emailError }}</div>\r\n                            </div>\r\n\r\n                            <div class=\"mb-4\">\r\n                                <input\r\n                                    type=\"password\"\r\n                                    class=\"form-control\"\r\n                                    placeholder=\"Mật khẩu\"\r\n                                    v-model=\"User.password\"\r\n                                    @blur=\"validatePassword\"\r\n                                />\r\n                                <div v-if=\"passwordError\" class=\"text-danger\">{{ passwordError }}</div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"text-center m-4\">\r\n                        <button type=\"submit\" class=\"btn btn-primary\">Đăng Nhập</button>\r\n                    </div>\r\n                </form>\r\n                <div v-if=\"errorMessage\" class=\"text-danger text-center\">{{ errorMessage }}</div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue';\r\nimport { useToast } from 'vue-toast-notification';\r\nimport Api from '~/service/Base/api.ts';\r\nconst toast = useToast();\r\n/** auth */\r\ndefinePageMeta({\r\n    layout: false,\r\n});\r\n\r\n/**init data */\r\nconst User = ref({\r\n    email: '',\r\n    password: '',\r\n});\r\nconst errorMessage = ref('');\r\nconst emailError = ref(null);\r\nconst passwordError = ref(null);\r\nconst api = new Api();\r\n\r\n/**\r\n * Validation logic\r\n */\r\nconst validateEmail = () => {\r\n    const emailPattern = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    if (!User.value.email) {\r\n        emailError.value = 'Email không được để trống';\r\n    } else if (!emailPattern.test(User.value.email)) {\r\n        emailError.value = 'Vui lòng nhập email hợp lệ';\r\n    } else {\r\n        emailError.value = null;\r\n    }\r\n};\r\n\r\nconst validatePassword = () => {\r\n    if (!User.value.password) {\r\n        passwordError.value = 'Mật khẩu không được để trống';\r\n    } else if (User.value.password.length < 5) {\r\n        passwordError.value = 'Mật khẩu phải có ít nhất 5 ký tự!';\r\n    } else if (!/(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)/.test(User.value.password)) {\r\n        passwordError.value = 'Mật khẩu phải có ít nhất 5 ký tự gồm chữ hoa, chữ thường và số.';\r\n    } else {\r\n        passwordError.value = null;\r\n    }\r\n};\r\n\r\n/**\r\n * Handle login\r\n */\r\nconst login = async () => {\r\n    // Validate before submitting\r\n    validateEmail();\r\n    validatePassword();\r\n    if (emailError.value || passwordError.value) {\r\n        return;\r\n    }\r\n    \r\n    try {\r\n        const loginData = {\r\n            email: User.value.email,\r\n            password: User.value.password\r\n        };\r\n        const response = await api.postAPI('/Account/login', loginData);\r\n        if (response.status === 200) {\r\n            if (response.data && response.data.message) {\r\n                // Hiển thị thông báo thành công\r\n                toast.success(response.data.message);  // Hiển thị thông báo với toast (thành công)\r\n            }\r\n        }\r\n        // Save login info to localStorage\r\n        localStorage.setItem('token', response.data.responseData.accessToken);\r\n        localStorage.setItem('userId', response.data.responseData.userId);\r\n        localStorage.setItem('userFullName', response.data.responseData.userFullName);\r\n        localStorage.setItem('email', response.data.responseData.email);\r\n        localStorage.setItem('role', response.data.responseData.role);\r\n\r\n        navigateTo('/booking');\r\n        //toast.success('Đăng nhập thành công!');\r\n    } catch (error) {\r\n        console.log(error);\r\n        // Kiểm tra lỗi từ server và hiển thị thông báo tương ứng\r\n        if (error.response && error.response.data && error.response.data.message) {\r\n            errorMessage.value = error.response.data.message;\r\n        } else {\r\n            errorMessage.value = 'Tên đăng nhập hoặc mật khẩu không đúng';\r\n        }\r\n    }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.bg-light {\r\n    background-color: rgba(255, 255, 255, 0.9);\r\n}\r\n\r\n.shadow {\r\n    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.text-danger {\r\n    color: #dc3545 !important; /* Màu đỏ đậm cho thông báo lỗi */\r\n    font-size: 1rem;\r\n}\r\n\r\n</style>\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAe,aAAA,KAAA,iBAAA,oBAAA;;;;;ACsDD,aAAW;AAOzB,UAAM,OAAO,IAAI;AAAA,MACb,OAAO;AAAA,MACP,UAAU;AAAA,IACd,CAAC;AACD,UAAM,eAAe,IAAI,EAAE;AAC3B,UAAM,aAAa,IAAI,IAAI;AAC3B,UAAM,gBAAgB,IAAI,IAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}